{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.4", "generated_at": "2025-07-18T13:57:10.353101Z", "invocation_id": "de49c04e-4689-4ba3-81f2-aa143728e786", "invocation_started_at": "2025-07-18T13:57:08.118239Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.475506Z", "completed_at": "2025-07-18T13:57:09.477249Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.481252Z", "completed_at": "2025-07-18T13:57:09.481277Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018506288528442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.ecommerce_analytics.raw_order_items", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.468280Z", "completed_at": "2025-07-18T13:57:09.474901Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.484514Z", "completed_at": "2025-07-18T13:57:09.484533Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022518634796142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.ecommerce_analytics.raw_customers", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.478530Z", "completed_at": "2025-07-18T13:57:09.480687Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.485602Z", "completed_at": "2025-07-18T13:57:09.485617Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02133011817932129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.ecommerce_analytics.raw_orders", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.482223Z", "completed_at": "2025-07-18T13:57:09.483750Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.487630Z", "completed_at": "2025-07-18T13:57:09.487652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021098613739013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.ecommerce_analytics.raw_products", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.511308Z", "completed_at": "2025-07-18T13:57:09.519513Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.533864Z", "completed_at": "2025-07-18T13:57:09.533882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04182291030883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_customers_email.608cd6ea33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_customers\"\nwhere email is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_customers_email\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.496404Z", "completed_at": "2025-07-18T13:57:09.520459Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.535145Z", "completed_at": "2025-07-18T13:57:09.535175Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04482436180114746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_customers_customer_id.f426cafd6c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_customers\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.526353Z", "completed_at": "2025-07-18T13:57:09.536661Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.537489Z", "completed_at": "2025-07-18T13:57:09.537500Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04796004295349121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_order_items_order_item_id.05372712ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_order_items\"\nwhere order_item_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_order_items_order_item_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.521209Z", "completed_at": "2025-07-18T13:57:09.544734Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.549271Z", "completed_at": "2025-07-18T13:57:09.549286Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.056448936462402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_order_items_order_id.fc0c385eb7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_order_items\"\nwhere order_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_order_items_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.551778Z", "completed_at": "2025-07-18T13:57:09.570339Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.577253Z", "completed_at": "2025-07-18T13:57:09.577271Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026671648025512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_products_product_id.896e463000", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_products\"\nwhere product_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_products_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.559123Z", "completed_at": "2025-07-18T13:57:09.578471Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.581090Z", "completed_at": "2025-07-18T13:57:09.581128Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03444027900695801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_orders_order_id.0446f9be68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_orders\"\nwhere order_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.565279Z", "completed_at": "2025-07-18T13:57:09.579203Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.591530Z", "completed_at": "2025-07-18T13:57:09.591547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04362010955810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_order_items_product_id.9ac38eb293", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_order_items\"\nwhere product_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_order_items_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.571251Z", "completed_at": "2025-07-18T13:57:09.582963Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.596708Z", "completed_at": "2025-07-18T13:57:09.596754Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04843544960021973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_orders_customer_id.3295e5b2a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_orders\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_orders_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.606137Z", "completed_at": "2025-07-18T13:57:09.618133Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.634360Z", "completed_at": "2025-07-18T13:57:09.634378Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04385709762573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_main_raw_customers_customer_id.3c5c7a27fa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"raw_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_unique_main_raw_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.600536Z", "completed_at": "2025-07-18T13:57:09.630964Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.636349Z", "completed_at": "2025-07-18T13:57:09.636366Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.047036170959472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_main_raw_products_product_name.80ac6c46bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"raw_products\"\nwhere product_name is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_not_null_main_raw_products_product_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.624569Z", "completed_at": "2025-07-18T13:57:09.641594Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.658460Z", "completed_at": "2025-07-18T13:57:09.658473Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05905961990356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_main_raw_customers_email.30ac4b3945", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"raw_customers\"\nwhere email is not null\ngroup by email\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_unique_main_raw_customers_email\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.618953Z", "completed_at": "2025-07-18T13:57:09.631887Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.656542Z", "completed_at": "2025-07-18T13:57:09.656562Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04011225700378418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_main_raw_order_items_order_item_id.493a49d39d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"raw_order_items\"\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_unique_main_raw_order_items_order_item_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.644245Z", "completed_at": "2025-07-18T13:57:09.667528Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.669573Z", "completed_at": "2025-07-18T13:57:09.669587Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030718564987182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_main_raw_orders_order_id.059f8b303d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"raw_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_unique_main_raw_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.649690Z", "completed_at": "2025-07-18T13:57:09.676065Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.681343Z", "completed_at": "2025-07-18T13:57:09.681358Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.041350603103637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_main_raw_products_product_id.b5cec7e81b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"raw_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"source_unique_main_raw_products_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.670656Z", "completed_at": "2025-07-18T13:57:09.684817Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.688084Z", "completed_at": "2025-07-18T13:57:09.688099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02142786979675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_order_items", "compiled": true, "compiled_code": "-- Staging model for order items\n-- This model cleans and standardizes raw order item data\n\n\n\nwith source_data as (\n    select \n        order_item_id,\n        order_id,\n        product_id,\n        quantity,\n        unit_price_cents,\n        created_at,\n        updated_at\n    from \"ecommerce_analytics\".\"main\".\"raw_order_items\"\n),\n\ncleaned as (\n    select\n        order_item_id,\n        order_id,\n        product_id,\n        quantity,\n        unit_price_cents,\n        created_at,\n        updated_at,\n        \n        -- Derived fields\n        \n    round(unit_price_cents / 100.0, 2)\n as unit_price_dollars,\n        quantity * unit_price_cents as line_total_cents,\n        \n    round(quantity * unit_price_cents / 100.0, 2)\n as line_total_dollars,\n        \n        -- Data quality flags\n        case \n            when order_id is null then false\n            when product_id is null then false\n            when quantity <= 0 then false\n            when unit_price_cents <= 0 then false\n            else true\n        end as is_valid_order_item\n        \n    from source_data\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_analytics\".\"main\".\"stg_order_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.676571Z", "completed_at": "2025-07-18T13:57:09.682929Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.683668Z", "completed_at": "2025-07-18T13:57:09.683680Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017718076705932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_customers", "compiled": true, "compiled_code": "-- Staging model for customers\n-- This model cleans and standardizes raw customer data\n\n\n\nwith source_data as (\n    select \n        customer_id,\n        email,\n        first_name,\n        last_name,\n        created_at,\n        updated_at\n    from \"ecommerce_analytics\".\"main\".\"raw_customers\"\n),\n\ncleaned as (\n    select\n        customer_id,\n        lower(trim(email)) as email,\n        trim(first_name) as first_name,\n        trim(last_name) as last_name,\n        created_at,\n        updated_at,\n        \n        -- Derived fields\n        concat(trim(first_name), ' ', trim(last_name)) as full_name,\n        case \n            when email like '%@gmail.com' then 'Gmail'\n            when email like '%@yahoo.com' then 'Yahoo'\n            when email like '%@hotmail.com' then 'Hotmail'\n            when email like '%@outlook.com' then 'Outlook'\n            else 'Other'\n        end as email_provider,\n        \n        -- Data quality flags\n        case \n            when first_name is null or first_name = '' then false\n            when last_name is null or last_name = '' then false\n            when email is null or email = '' then false\n            when email not like '%@%' then false\n            else true\n        end as is_valid_customer\n        \n    from source_data\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_analytics\".\"main\".\"stg_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.690270Z", "completed_at": "2025-07-18T13:57:09.694812Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.699769Z", "completed_at": "2025-07-18T13:57:09.699806Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013530492782592773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.ecommerce_analytics.customers_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    customer_id,\n    email,\n    first_name,\n    last_name,\n    created_at,\n    updated_at\nfrom \"ecommerce_analytics\".\"main\".\"raw_customers\"\n", "relation_name": "\"ecommerce_analytics\".\"snapshots\".\"customers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.703043Z", "completed_at": "2025-07-18T13:57:09.714468Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.727228Z", "completed_at": "2025-07-18T13:57:09.727245Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02920246124267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_orders", "compiled": true, "compiled_code": "-- Staging model for orders\n-- This model cleans and standardizes raw order data\n\n\n\nwith source_data as (\n    select \n        order_id,\n        customer_id,\n        order_date,\n        status,\n        total_amount_cents,\n        created_at,\n        updated_at\n    from \"ecommerce_analytics\".\"main\".\"raw_orders\"\n),\n\ncleaned as (\n    select\n        order_id,\n        customer_id,\n        order_date,\n        lower(trim(status)) as status,\n        total_amount_cents,\n        created_at,\n        updated_at,\n        \n        -- Derived fields\n        \n    round(total_amount_cents / 100.0, 2)\n as total_amount_dollars,\n        \n        case \n            when lower(trim(status)) = 'completed' then 'completed'\n            when lower(trim(status)) = 'pending' then 'pending'\n            when lower(trim(status)) = 'cancelled' then 'cancelled'\n            when lower(trim(status)) = 'refunded' then 'refunded'\n            else 'unknown'\n        end as order_status_clean,\n        \n        case \n            when lower(trim(status)) = 'completed' then true\n            else false\n        end as is_completed_order,\n        \n        -- Time-based fields\n        extract(year from order_date) as order_year,\n        extract(month from order_date) as order_month,\n        extract(day from order_date) as order_day,\n        extract(dayofweek from order_date) as order_day_of_week,\n        \n        -- Data quality flags\n        case \n            when order_date is null then false\n            when customer_id is null then false\n            when total_amount_cents < 0 then false\n            else true\n        end as is_valid_order\n        \n    from source_data\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_analytics\".\"main\".\"stg_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.709193Z", "completed_at": "2025-07-18T13:57:09.726579Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.732540Z", "completed_at": "2025-07-18T13:57:09.732553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03548789024353027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_products", "compiled": true, "compiled_code": "-- Staging model for products\n-- This model cleans and standardizes raw product data\n\nwith source_data as (\n    select \n        product_id,\n        product_name,\n        category,\n        price_cents,\n        created_at,\n        updated_at\n    from \"ecommerce_analytics\".\"main\".\"raw_products\"\n),\n\ncleaned as (\n    select\n        product_id,\n        trim(product_name) as product_name,\n        lower(trim(category)) as category,\n        price_cents,\n        created_at,\n        updated_at,\n        \n        -- Derived fields\n        \n    round(price_cents / 100.0, 2)\n as price_dollars,\n        \n        case \n            when lower(trim(category)) = 'electronics' then 'Electronics'\n            when lower(trim(category)) = 'footwear' then 'Footwear'\n            when lower(trim(category)) = 'kitchen' then 'Kitchen'\n            when lower(trim(category)) = 'fitness' then 'Fitness'\n            when lower(trim(category)) = 'home office' then 'Home Office'\n            else 'Other'\n        end as category_clean,\n        \n        -- Price tiers\n        case \n            when price_cents < 2500 then 'Low'\n            when price_cents between 2500 and 7500 then 'Medium'\n            when price_cents > 7500 then 'High'\n            else 'Unknown'\n        end as price_tier,\n        \n        -- Data quality flags\n        case \n            when product_name is null or product_name = '' then false\n            when category is null or category = '' then false\n            when price_cents <= 0 then false\n            else true\n        end as is_valid_product\n        \n    from source_data\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_analytics\".\"main\".\"stg_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.715305Z", "completed_at": "2025-07-18T13:57:09.731861Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.735262Z", "completed_at": "2025-07-18T13:57:09.735275Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03308463096618652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_stg_customers_email_provider__Gmail__Yahoo__Hotmail__Outlook__Other.2f35895c03", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        email_provider as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"stg_customers\"\n    group by email_provider\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Gmail','Yahoo','Hotmail','Outlook','Other'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_stg_customers_6ae51e27138289c85481fd5bf20a9afb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.728163Z", "completed_at": "2025-07-18T13:57:09.736234Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.739199Z", "completed_at": "2025-07-18T13:57:09.739211Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025615930557250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.assert_valid_email_format", "compiled": true, "compiled_code": "-- Custom singular test to validate email format\n-- This test ensures all customer emails contain @ symbol and domain\n\nselect\n    customer_id,\n    email,\n    full_name\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere email is not null\n  and (\n      email not like '%@%'\n      or email not like '%.%'\n      or length(email) < 5\n  )", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"assert_valid_email_format\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.743553Z", "completed_at": "2025-07-18T13:57:09.757893Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.760200Z", "completed_at": "2025-07-18T13:57:09.760212Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0225985050201416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.749552Z", "completed_at": "2025-07-18T13:57:09.759373Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.762417Z", "completed_at": "2025-07-18T13:57:09.762433Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02233290672302246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere email is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_customers_email\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.753313Z", "completed_at": "2025-07-18T13:57:09.761041Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.769714Z", "completed_at": "2025-07-18T13:57:09.769724Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02840733528137207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_customers_first_name.57f99cf033", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere first_name is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_customers_first_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.763364Z", "completed_at": "2025-07-18T13:57:09.773609Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.780837Z", "completed_at": "2025-07-18T13:57:09.780852Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03211545944213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_customers_is_valid_customer.3aaa120960", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere is_valid_customer is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_customers_is_valid_customer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.774374Z", "completed_at": "2025-07-18T13:57:09.788673Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.792508Z", "completed_at": "2025-07-18T13:57:09.792526Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0219879150390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_customers_last_name.fa1ab1e186", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere last_name is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_customers_last_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.782140Z", "completed_at": "2025-07-18T13:57:09.791021Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.798521Z", "completed_at": "2025-07-18T13:57:09.798534Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019323348999023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere email is not null\ngroup by email\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_stg_customers_email\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.794461Z", "completed_at": "2025-07-18T13:57:09.801025Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.803242Z", "completed_at": "2025-07-18T13:57:09.803257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015484094619750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_stg_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.808640Z", "completed_at": "2025-07-18T13:57:09.823605Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.826003Z", "completed_at": "2025-07-18T13:57:09.826017Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026026248931884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_stg_orders_order_status_clean__completed__pending__cancelled__refunded__unknown.0f9d42ba14", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_status_clean as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"stg_orders\"\n    group by order_status_clean\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'completed','pending','cancelled','refunded','unknown'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_stg_orders_357b5bd04938176d58995d3c36ae356c\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.819906Z", "completed_at": "2025-07-18T13:57:09.827035Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.833199Z", "completed_at": "2025-07-18T13:57:09.833216Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028811931610107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.assert_positive_order_amounts", "compiled": true, "compiled_code": "-- Custom singular test to ensure all completed orders have positive amounts\n-- This test checks data quality for order totals\n\nselect\n    order_id,\n    customer_id,\n    order_date,\n    order_status_clean,\n    total_amount_dollars\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere order_status_clean = 'completed'\n  and total_amount_dollars <= 0", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"assert_positive_order_amounts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.805208Z", "completed_at": "2025-07-18T13:57:09.818417Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.824384Z", "completed_at": "2025-07-18T13:57:09.824399Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02507758140563965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.assert_order_item_consistency", "compiled": true, "compiled_code": "-- Custom singular test to check order item consistency\n-- This test validates that order totals match sum of line items\n\nwith order_totals as (\n    select\n        order_id,\n        total_amount_dollars\n    from \"ecommerce_analytics\".\"main\".\"stg_orders\"\n    where is_completed_order = true\n),\n\nline_item_totals as (\n    select\n        order_id,\n        sum(line_total_dollars) as calculated_total\n    from \"ecommerce_analytics\".\"main\".\"stg_order_items\"\n    where is_valid_order_item = true\n    group by order_id\n),\n\ncomparison as (\n    select\n        ot.order_id,\n        ot.total_amount_dollars as order_total,\n        lit.calculated_total as line_items_total,\n        abs(ot.total_amount_dollars - lit.calculated_total) as difference\n    from order_totals ot\n    inner join line_item_totals lit on ot.order_id = lit.order_id\n)\n\nselect\n    order_id,\n    order_total,\n    line_items_total,\n    difference\nfrom comparison\nwhere difference > 0.01  -- Allow for small rounding differences", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"assert_order_item_consistency\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.828375Z", "completed_at": "2025-07-18T13:57:09.835936Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.846430Z", "completed_at": "2025-07-18T13:57:09.846454Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027480125427246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_orders_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.841956Z", "completed_at": "2025-07-18T13:57:09.859744Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.861916Z", "completed_at": "2025-07-18T13:57:09.861934Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023406028747558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere order_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.853189Z", "completed_at": "2025-07-18T13:57:09.860761Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.862853Z", "completed_at": "2025-07-18T13:57:09.862867Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02541351318359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_orders_order_date.2177a3e8bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere order_date is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_orders_order_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.847782Z", "completed_at": "2025-07-18T13:57:09.863698Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.866735Z", "completed_at": "2025-07-18T13:57:09.866748Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030127286911010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_orders_is_completed_order.84479a6f31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere is_completed_order is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_orders_is_completed_order\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.882259Z", "completed_at": "2025-07-18T13:57:09.908249Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.908765Z", "completed_at": "2025-07-18T13:57:09.908775Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03366684913635254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"ecommerce_analytics\".\"main\".\"stg_orders\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"ecommerce_analytics\".\"main\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.867945Z", "completed_at": "2025-07-18T13:57:09.878284Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.901501Z", "completed_at": "2025-07-18T13:57:09.901518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.040406227111816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount_cents.5d9fa23eac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere total_amount_cents is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_stg_orders_total_amount_cents\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.896645Z", "completed_at": "2025-07-18T13:57:09.912555Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.913225Z", "completed_at": "2025-07-18T13:57:09.913238Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.037192344665527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"stg_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_stg_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.902776Z", "completed_at": "2025-07-18T13:57:09.914395Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.919983Z", "completed_at": "2025-07-18T13:57:09.920008Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03945207595825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.int_order_items_enhanced", "compiled": true, "compiled_code": "-- Intermediate model that enriches order items with product and order information\n-- This model joins order items with product and order data for analysis\n\n\n\nwith order_items as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_order_items\"\n    where is_valid_order_item = true\n),\n\nproducts as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_products\"\n    where is_valid_product = true\n),\n\norders as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_orders\"\n    where is_valid_order = true\n),\n\nenhanced_order_items as (\n    select\n        oi.order_item_id,\n        oi.order_id,\n        oi.product_id,\n        oi.quantity,\n        oi.unit_price_cents,\n        oi.unit_price_dollars,\n        oi.line_total_cents,\n        oi.line_total_dollars,\n        oi.created_at as order_item_created_at,\n        \n        -- Product information\n        p.product_name,\n        p.category,\n        p.category_clean,\n        p.price_cents as product_list_price_cents,\n        p.price_dollars as product_list_price_dollars,\n        p.price_tier,\n        \n        -- Order information\n        o.customer_id,\n        o.order_date,\n        o.order_status_clean,\n        o.total_amount_cents as order_total_cents,\n        o.total_amount_dollars as order_total_dollars,\n        o.order_year,\n        o.order_month,\n        o.is_completed_order,\n        \n        -- Derived metrics\n        oi.unit_price_cents - p.price_cents as price_discount_cents,\n        oi.unit_price_dollars - p.price_dollars as price_discount_dollars,\n        \n        case \n            when p.price_cents > 0 then \n                round(((p.price_cents - oi.unit_price_cents) * 100.0) / p.price_cents, 2)\n            else 0\n        end as discount_percentage,\n        \n        -- Revenue attribution\n        case \n            when o.is_completed_order then oi.line_total_dollars\n            else 0\n        end as revenue_dollars,\n        \n        -- Product performance flags\n        case \n            when oi.unit_price_cents < p.price_cents then true\n            else false\n        end as is_discounted,\n        \n        case \n            when oi.quantity > 1 then true\n            else false\n        end as is_multi_quantity\n        \n    from order_items oi\n    inner join products p on oi.product_id = p.product_id\n    inner join orders o on oi.order_id = o.order_id\n)\n\nselect * from enhanced_order_items", "relation_name": "\"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.938432Z", "completed_at": "2025-07-18T13:57:09.945362Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.946637Z", "completed_at": "2025-07-18T13:57:09.946649Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020138978958129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.dim_products", "compiled": true, "compiled_code": "-- Product dimension table\n-- This model provides the definitive product dimension for analytics\n\nwith products as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_products\"\n    where is_valid_product = true\n),\n\nproduct_performance as (\n    select\n        product_id,\n        count(distinct order_id) as total_orders,\n        sum(quantity) as total_quantity_sold,\n        sum(revenue_dollars) as total_revenue,\n        avg(revenue_dollars) as avg_revenue_per_order,\n        count(distinct customer_id) as unique_customers\n    from \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\n    where is_completed_order = true\n    group by product_id\n),\n\nfinal as (\n    select\n        p.product_id,\n        p.product_name,\n        p.category,\n        p.category_clean,\n        p.price_cents,\n        p.price_dollars,\n        p.price_tier,\n        p.created_at as product_created_at,\n        p.updated_at as product_updated_at,\n        \n        -- Performance metrics\n        coalesce(pp.total_orders, 0) as total_orders,\n        coalesce(pp.total_quantity_sold, 0) as total_quantity_sold,\n        coalesce(pp.total_revenue, 0) as total_revenue,\n        coalesce(pp.avg_revenue_per_order, 0) as avg_revenue_per_order,\n        coalesce(pp.unique_customers, 0) as unique_customers,\n        \n        -- Performance flags\n        case \n            when pp.total_orders >= 5 then 'High Performer'\n            when pp.total_orders >= 2 then 'Medium Performer'\n            when pp.total_orders >= 1 then 'Low Performer'\n            else 'No Sales'\n        end as performance_tier,\n        \n        case \n            when pp.total_revenue > 0 then \n                round(pp.total_revenue / pp.total_quantity_sold, 2)\n            else 0\n        end as avg_selling_price,\n        \n        -- Data quality\n        current_timestamp as last_updated\n        \n    from products p\n    left join product_performance pp on p.product_id = pp.product_id\n)\n\nselect * from final", "relation_name": "\"ecommerce_analytics\".\"main\".\"dim_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.932897Z", "completed_at": "2025-07-18T13:57:09.946047Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.958321Z", "completed_at": "2025-07-18T13:57:09.958355Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029883623123168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.fct_order_items", "compiled": true, "compiled_code": "-- Order items fact table\n-- This model provides order item-level facts for detailed analytics\n\n\n\nwith order_items_enhanced as (\n    select * from \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\n),\n\nfinal as (\n    select\n        order_item_id,\n        order_id,\n        product_id,\n        customer_id,\n        order_date,\n        quantity,\n        unit_price_cents,\n        unit_price_dollars,\n        line_total_cents,\n        line_total_dollars,\n        \n        -- Product attributes\n        product_name,\n        category,\n        category_clean,\n        product_list_price_cents,\n        product_list_price_dollars,\n        price_tier,\n        \n        -- Order attributes\n        order_status_clean,\n        order_total_cents,\n        order_total_dollars,\n        order_year,\n        order_month,\n        is_completed_order,\n        \n        -- Pricing analysis\n        price_discount_cents,\n        price_discount_dollars,\n        discount_percentage,\n        is_discounted,\n        \n        -- Business metrics\n        revenue_dollars,\n        is_multi_quantity,\n        \n        -- Advanced metrics\n        case \n            when order_total_dollars > 0 then \n                round(line_total_dollars / order_total_dollars * 100, 2)\n            else 0\n        end as line_item_percentage_of_order,\n        \n        case \n            when price_discount_dollars > 0 then \n                price_discount_dollars * quantity\n            else 0\n        end as total_discount_dollars,\n        \n        -- Data quality\n        current_timestamp as last_updated\n        \n    from order_items_enhanced\n)\n\nselect * from final", "relation_name": "\"ecommerce_analytics\".\"main\".\"fct_order_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.947889Z", "completed_at": "2025-07-18T13:57:09.973357Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.977197Z", "completed_at": "2025-07-18T13:57:09.977212Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.047951698303222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.fct_orders", "compiled": true, "compiled_code": "-- Orders fact table\n-- This model provides order-level facts for analytics\n\n\n\nwith orders as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_orders\"\n    where is_valid_order = true\n),\n\norder_items_agg as (\n    select\n        order_id,\n        count(*) as total_items,\n        sum(quantity) as total_quantity,\n        sum(line_total_dollars) as calculated_total_dollars,\n        count(distinct product_id) as unique_products,\n        count(distinct category_clean) as unique_categories\n    from \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\n    group by order_id\n),\n\nfinal as (\n    select\n        o.order_id,\n        o.customer_id,\n        o.order_date,\n        o.status,\n        o.order_status_clean,\n        o.total_amount_cents,\n        o.total_amount_dollars,\n        o.order_year,\n        o.order_month,\n        o.order_day,\n        o.order_day_of_week,\n        o.is_completed_order,\n        o.created_at as order_created_at,\n        o.updated_at as order_updated_at,\n        \n        -- Order item aggregations\n        coalesce(oia.total_items, 0) as total_items,\n        coalesce(oia.total_quantity, 0) as total_quantity,\n        coalesce(oia.calculated_total_dollars, 0) as calculated_total_dollars,\n        coalesce(oia.unique_products, 0) as unique_products,\n        coalesce(oia.unique_categories, 0) as unique_categories,\n        \n        -- Data quality checks\n        case \n            when abs(o.total_amount_dollars - coalesce(oia.calculated_total_dollars, 0)) <= 0.01 \n            then true\n            else false\n        end as totals_match,\n        \n        -- Business logic\n        case \n            when o.is_completed_order then o.total_amount_dollars\n            else 0\n        end as revenue_dollars,\n        \n        case \n            when coalesce(oia.unique_products, 0) > 3 then 'Large Basket'\n            when coalesce(oia.unique_products, 0) > 1 then 'Medium Basket'\n            when coalesce(oia.unique_products, 0) = 1 then 'Single Item'\n            else 'Empty Basket'\n        end as basket_size_category,\n        \n        -- Time-based attributes\n        case \n            when o.order_day_of_week in (1, 7) then 'Weekend'\n            else 'Weekday'\n        end as weekend_flag,\n        \n        -- Data quality\n        current_timestamp as last_updated\n        \n    from orders o\n    left join order_items_agg oia on o.order_id = oia.order_id\n    \n    \n        where o.updated_at > (select max(order_updated_at) from \"ecommerce_analytics\".\"main\".\"fct_orders\")\n    \n)\n\nselect * from final", "relation_name": "\"ecommerce_analytics\".\"main\".\"fct_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.963903Z", "completed_at": "2025-07-18T13:57:09.974224Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.978690Z", "completed_at": "2025-07-18T13:57:09.978708Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04779553413391113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.int_customer_order_history", "compiled": true, "compiled_code": "-- Intermediate model that aggregates customer order history\n-- This model provides customer-level metrics and segments\n\n\n\nwith customers as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_customers\"\n    where is_valid_customer = true\n),\n\norders as (\n    select * from \"ecommerce_analytics\".\"main\".\"stg_orders\"\n    where is_valid_order = true\n),\n\norder_items as (\n    select * from \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\n),\n\ncustomer_orders as (\n    select\n        c.customer_id,\n        c.email,\n        c.first_name,\n        c.last_name,\n        c.full_name,\n        c.email_provider,\n        c.created_at as customer_created_at,\n        \n        -- Order counts\n        count(distinct o.order_id) as total_orders,\n        count(distinct case when o.is_completed_order then o.order_id end) as completed_orders,\n        count(distinct case when o.order_status_clean = 'cancelled' then o.order_id end) as cancelled_orders,\n        \n        -- Revenue metrics\n        sum(case when o.is_completed_order then o.total_amount_dollars else 0 end) as total_revenue_dollars,\n        avg(case when o.is_completed_order then o.total_amount_dollars end) as avg_order_value_dollars,\n        \n        -- Time-based metrics\n        min(o.order_date) as first_order_date,\n        max(o.order_date) as last_order_date,\n        max(o.order_date) - min(o.order_date) as customer_lifespan_days,\n        \n        -- Product diversity\n        count(distinct oi.product_id) as unique_products_purchased,\n        count(distinct oi.category_clean) as unique_categories_purchased,\n        \n        -- Behavioral flags\n        case \n            when count(distinct o.order_id) = 1 then 'One-time'\n            when count(distinct o.order_id) between 2 and 5 then 'Occasional'\n            when count(distinct o.order_id) > 5 then 'Frequent'\n            else 'Unknown'\n        end as customer_segment,\n        \n        case \n            when max(o.order_date) >= current_date - interval '90 days' then 'Active'\n            when max(o.order_date) >= current_date - interval '365 days' then 'Dormant'\n            else 'Inactive'\n        end as customer_status\n        \n    from customers c\n    left join orders o on c.customer_id = o.customer_id\n    left join order_items oi on o.order_id = oi.order_id\n    \n    group by 1, 2, 3, 4, 5, 6, 7\n)\n\nselect * from customer_orders", "relation_name": "\"ecommerce_analytics\".\"main\".\"int_customer_order_history\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.980929Z", "completed_at": "2025-07-18T13:57:09.997279Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:09.999139Z", "completed_at": "2025-07-18T13:57:09.999152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024080276489257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_int_order_items_enhanced_category_clean__Electronics__Footwear__Kitchen__Fitness__Home_Office__Other.7d7e93e96b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category_clean as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\n    group by category_clean\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Electronics','Footwear','Kitchen','Fitness','Home Office','Other'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_int_order_item_7131439ea5e1ed088814ab64b0d4a38b\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:09.991832Z", "completed_at": "2025-07-18T13:57:10.000617Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.007241Z", "completed_at": "2025-07-18T13:57:10.007257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03126072883605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_order_items_enhanced_is_discounted.c18d10842a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\nwhere is_discounted is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_order_items_enhanced_is_discounted\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.003178Z", "completed_at": "2025-07-18T13:57:10.021118Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.024400Z", "completed_at": "2025-07-18T13:57:10.024418Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026757240295410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_order_items_enhanced_order_item_id.457b16797c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\nwhere order_item_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_order_items_enhanced_order_item_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.008265Z", "completed_at": "2025-07-18T13:57:10.022894Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.029834Z", "completed_at": "2025-07-18T13:57:10.029847Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031531333923339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_order_items_enhanced_order_id.d0ac78064f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\nwhere order_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_order_items_enhanced_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.025673Z", "completed_at": "2025-07-18T13:57:10.037544Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.040068Z", "completed_at": "2025-07-18T13:57:10.040081Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020870685577392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_order_items_enhanced_product_id.846361f149", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\nwhere product_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_order_items_enhanced_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.033344Z", "completed_at": "2025-07-18T13:57:10.040899Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.043745Z", "completed_at": "2025-07-18T13:57:10.043762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020427703857421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_order_items_enhanced_revenue_dollars.52fe54efef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\nwhere revenue_dollars is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_order_items_enhanced_revenue_dollars\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.044912Z", "completed_at": "2025-07-18T13:57:10.057397Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.060363Z", "completed_at": "2025-07-18T13:57:10.060373Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022200822830200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_int_order_items_enhanced_order_item_id.281e47f153", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"int_order_items_enhanced\"\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_int_order_items_enhanced_order_item_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.050097Z", "completed_at": "2025-07-18T13:57:10.059080Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.070708Z", "completed_at": "2025-07-18T13:57:10.070724Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03180742263793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_dim_products_category_clean__Electronics__Footwear__Kitchen__Fitness__Home_Office__Other.ae9e9f99c0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category_clean as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"dim_products\"\n    group by category_clean\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Electronics','Footwear','Kitchen','Fitness','Home Office','Other'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_dim_products_bd73a921facd83794e4997152cb37e18\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.061229Z", "completed_at": "2025-07-18T13:57:10.077666Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.079793Z", "completed_at": "2025-07-18T13:57:10.079817Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02440929412841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_dim_products_performance_tier__High_Performer__Medium_Performer__Low_Performer__No_Sales.043ae35a66", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        performance_tier as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"dim_products\"\n    group by performance_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'High Performer','Medium Performer','Low Performer','No Sales'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_dim_products_608446c3b5efd14a1bfac28a75d00526\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.073847Z", "completed_at": "2025-07-18T13:57:10.081290Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.083719Z", "completed_at": "2025-07-18T13:57:10.083727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02415299415588379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_products_price_dollars.b17d26a81d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_products\"\nwhere price_dollars is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_products_price_dollars\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.092850Z", "completed_at": "2025-07-18T13:57:10.097373Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.099840Z", "completed_at": "2025-07-18T13:57:10.099855Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016756057739257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"dim_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_dim_products_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.088389Z", "completed_at": "2025-07-18T13:57:10.097871Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.100755Z", "completed_at": "2025-07-18T13:57:10.100768Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02257513999938965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_products\"\nwhere product_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_products_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.084442Z", "completed_at": "2025-07-18T13:57:10.099268Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.102334Z", "completed_at": "2025-07-18T13:57:10.102344Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023520231246948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_products_product_name.991aec73f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_products\"\nwhere product_name is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_products_product_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.104572Z", "completed_at": "2025-07-18T13:57:10.111590Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.124004Z", "completed_at": "2025-07-18T13:57:10.124023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025580406188964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.ecommerce_analytics.monthly_sales_trends", "compiled": true, "compiled_code": "-- Analysis: Monthly Sales Trends\n-- This analysis shows sales performance over time with various metrics\n\nwith monthly_sales as (\n    select\n        order_year,\n        order_month,\n        count(distinct order_id) as total_orders,\n        count(distinct customer_id) as unique_customers,\n        sum(revenue_dollars) as total_revenue,\n        avg(revenue_dollars) as avg_order_value,\n        sum(total_items) as total_items_sold\n    from \"ecommerce_analytics\".\"main\".\"fct_orders\"\n    where is_completed_order = true\n    group by order_year, order_month\n),\n\nmonthly_trends as (\n    select\n        order_year,\n        order_month,\n        date(order_year || '-' || lpad(order_month::text, 2, '0') || '-01') as month_date,\n        total_orders,\n        unique_customers,\n        total_revenue,\n        avg_order_value,\n        total_items_sold,\n        \n        -- Month-over-month growth\n        lag(total_revenue) over (order by order_year, order_month) as prev_month_revenue,\n        lag(total_orders) over (order by order_year, order_month) as prev_month_orders,\n        \n        -- Customer metrics\n        round(total_revenue / nullif(unique_customers, 0), 2) as revenue_per_customer,\n        round(total_orders::float / nullif(unique_customers, 0), 2) as orders_per_customer\n    from monthly_sales\n),\n\nfinal as (\n    select\n        order_year,\n        order_month,\n        month_date,\n        total_orders,\n        unique_customers,\n        round(total_revenue, 2) as total_revenue,\n        round(avg_order_value, 2) as avg_order_value,\n        total_items_sold,\n        revenue_per_customer,\n        orders_per_customer,\n        \n        -- Growth calculations\n        case \n            when prev_month_revenue is not null and prev_month_revenue > 0 then\n                round((total_revenue - prev_month_revenue) / prev_month_revenue * 100, 2)\n            else null\n        end as revenue_growth_percent,\n        \n        case \n            when prev_month_orders is not null and prev_month_orders > 0 then\n                round((total_orders - prev_month_orders) / prev_month_orders::float * 100, 2)\n            else null\n        end as order_growth_percent\n        \n    from monthly_trends\n)\n\nselect * from final\norder by order_year, order_month", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.112838Z", "completed_at": "2025-07-18T13:57:10.125892Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.136444Z", "completed_at": "2025-07-18T13:57:10.136459Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027248620986938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"fct_orders\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_fct_orders_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.117125Z", "completed_at": "2025-07-18T13:57:10.132524Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.137931Z", "completed_at": "2025-07-18T13:57:10.137947Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029526710510253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fct_orders_order_date.84f0a76362", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"fct_orders\"\nwhere order_date is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_fct_orders_order_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.127356Z", "completed_at": "2025-07-18T13:57:10.140921Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.154261Z", "completed_at": "2025-07-18T13:57:10.154279Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04423713684082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_fct_orders_basket_size_category__Large_Basket__Medium_Basket__Single_Item__Empty_Basket.d3f482a900", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        basket_size_category as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"fct_orders\"\n    group by basket_size_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Large Basket','Medium Basket','Single Item','Empty Basket'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_fct_orders_8dd62e267dcca94ae283ab5d391994f5\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.142179Z", "completed_at": "2025-07-18T13:57:10.155376Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.161779Z", "completed_at": "2025-07-18T13:57:10.161794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02461552619934082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"fct_orders\"\nwhere order_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_fct_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.156581Z", "completed_at": "2025-07-18T13:57:10.163823Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.166500Z", "completed_at": "2025-07-18T13:57:10.166512Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025078535079956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fct_orders_revenue_dollars.ff8a261a7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"fct_orders\"\nwhere revenue_dollars is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_fct_orders_revenue_dollars\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.148703Z", "completed_at": "2025-07-18T13:57:10.165177Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.168104Z", "completed_at": "2025-07-18T13:57:10.168116Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020839691162109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fct_orders_totals_match.50f03ecdd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"fct_orders\"\nwhere totals_match is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_fct_orders_totals_match\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.168909Z", "completed_at": "2025-07-18T13:57:10.179737Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.181713Z", "completed_at": "2025-07-18T13:57:10.181729Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018504619598388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"fct_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_fct_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.175589Z", "completed_at": "2025-07-18T13:57:10.182601Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.190480Z", "completed_at": "2025-07-18T13:57:10.190490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0231320858001709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.dim_customers", "compiled": true, "compiled_code": "-- Customer dimension table\n-- This model provides the definitive customer dimension for analytics\n\n\n\nwith customer_history as (\n    select * from \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\n),\n\nfinal as (\n    select\n        customer_id,\n        email,\n        first_name,\n        last_name,\n        full_name,\n        email_provider,\n        customer_created_at,\n        \n        -- Order metrics\n        total_orders,\n        completed_orders,\n        cancelled_orders,\n        \n        -- Revenue metrics\n        total_revenue_dollars,\n        avg_order_value_dollars,\n        \n        -- Customer lifetime value (simple calculation)\n        case \n            when customer_lifespan_days > 0 then \n                total_revenue_dollars / nullif(customer_lifespan_days, 0) * 365\n            else total_revenue_dollars\n        end as estimated_annual_clv,\n        \n        -- Time metrics\n        first_order_date,\n        last_order_date,\n        customer_lifespan_days,\n        \n        -- Product metrics\n        unique_products_purchased,\n        unique_categories_purchased,\n        \n        -- Segmentation\n        customer_segment,\n        customer_status,\n        \n        -- Enrichment fields\n        case \n            when total_revenue_dollars >= 500 then 'High Value'\n            when total_revenue_dollars >= 200 then 'Medium Value'\n            when total_revenue_dollars > 0 then 'Low Value'\n            else 'No Value'\n        end as customer_value_tier,\n        \n        case \n            when completed_orders > 0 then \n                round(cancelled_orders * 100.0 / total_orders, 2)\n            else 0\n        end as cancellation_rate_percent,\n        \n        -- Data quality\n        current_timestamp as last_updated\n        \n    from customer_history\n)\n\nselect * from final", "relation_name": "\"ecommerce_analytics\".\"main\".\"dim_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.183627Z", "completed_at": "2025-07-18T13:57:10.198193Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.200796Z", "completed_at": "2025-07-18T13:57:10.200809Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025849103927612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_int_customer_order_history_customer_segment__One_time__Occasional__Frequent__Unknown.45f3e3e2ea", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'One-time','Occasional','Frequent','Unknown'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_int_customer_o_d8eacd1e5922276f4b8f3ffb3a79f5b8\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.191789Z", "completed_at": "2025-07-18T13:57:10.200302Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.206514Z", "completed_at": "2025-07-18T13:57:10.206526Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026368141174316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_int_customer_order_history_customer_status__Active__Dormant__Inactive.c2f7cbe4ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_status as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\n    group by customer_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Active','Dormant','Inactive'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_int_customer_o_0aba6b545f11fee25f5aeef76fae1d23\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.202285Z", "completed_at": "2025-07-18T13:57:10.209355Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.215896Z", "completed_at": "2025-07-18T13:57:10.215913Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018590688705444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_customer_order_history_completed_orders.f43c58758a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\nwhere completed_orders is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_customer_order_history_completed_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.210651Z", "completed_at": "2025-07-18T13:57:10.220495Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.232841Z", "completed_at": "2025-07-18T13:57:10.232855Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03134870529174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_customer_order_history_customer_id.fc08fe4fc9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_customer_order_history_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.226295Z", "completed_at": "2025-07-18T13:57:10.234304Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.236941Z", "completed_at": "2025-07-18T13:57:10.236954Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022002696990966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_customer_order_history_total_orders.ec8455da1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\nwhere total_orders is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_customer_order_history_total_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.221101Z", "completed_at": "2025-07-18T13:57:10.235075Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.237964Z", "completed_at": "2025-07-18T13:57:10.237994Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02815079689025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_int_customer_order_history_total_revenue_dollars.fd74e36893", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\nwhere total_revenue_dollars is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_int_customer_order_history_total_revenue_dollars\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.238986Z", "completed_at": "2025-07-18T13:57:10.245785Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.252142Z", "completed_at": "2025-07-18T13:57:10.252159Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020068883895874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_int_customer_order_history_customer_id.630943f1b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"int_customer_order_history\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_int_customer_order_history_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.247622Z", "completed_at": "2025-07-18T13:57:10.258937Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.261713Z", "completed_at": "2025-07-18T13:57:10.261727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01894354820251465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.ecommerce_analytics.customer_lifetime_value", "compiled": true, "compiled_code": "-- Analysis: Customer Lifetime Value Calculation\n-- This analysis provides insights into customer value and retention\n\nwith customer_metrics as (\n    select\n        customer_id,\n        full_name,\n        email,\n        customer_segment,\n        customer_value_tier,\n        total_orders,\n        total_revenue_dollars,\n        avg_order_value_dollars,\n        first_order_date,\n        last_order_date,\n        customer_lifespan_days,\n        estimated_annual_clv\n    from \"ecommerce_analytics\".\"main\".\"dim_customers\"\n    where total_orders > 0\n),\n\nclv_analysis as (\n    select\n        customer_segment,\n        customer_value_tier,\n        count(*) as customer_count,\n        avg(total_revenue_dollars) as avg_total_revenue,\n        avg(avg_order_value_dollars) as avg_order_value,\n        avg(total_orders) as avg_orders_per_customer,\n        avg(customer_lifespan_days) as avg_lifespan_days,\n        avg(estimated_annual_clv) as avg_annual_clv,\n        sum(total_revenue_dollars) as total_segment_revenue\n    from customer_metrics\n    group by customer_segment, customer_value_tier\n),\n\nfinal as (\n    select\n        customer_segment,\n        customer_value_tier,\n        customer_count,\n        round(avg_total_revenue, 2) as avg_total_revenue,\n        round(avg_order_value, 2) as avg_order_value,\n        round(avg_orders_per_customer, 1) as avg_orders_per_customer,\n        round(avg_lifespan_days, 0) as avg_lifespan_days,\n        round(avg_annual_clv, 2) as avg_annual_clv,\n        round(total_segment_revenue, 2) as total_segment_revenue,\n        round(total_segment_revenue / sum(total_segment_revenue) over() * 100, 2) as revenue_percentage\n    from clv_analysis\n)\n\nselect * from final\norder by total_segment_revenue desc", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.253062Z", "completed_at": "2025-07-18T13:57:10.260399Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.267265Z", "completed_at": "2025-07-18T13:57:10.267279Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02103400230407715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_dim_customers_customer_segment__One_time__Occasional__Frequent__Unknown.8c832b492b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"dim_customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'One-time','Occasional','Frequent','Unknown'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_dim_customers_d469805a1254eef990f9e2e5683e6f78\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.262572Z", "completed_at": "2025-07-18T13:57:10.275767Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.279549Z", "completed_at": "2025-07-18T13:57:10.279560Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022345304489135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_dim_customers_customer_status__Active__Dormant__Inactive.839ad6700a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_status as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"dim_customers\"\n    group by customer_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Active','Dormant','Inactive'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_dim_customers_b199b726dacd86ff04b42d8e4d09cfea\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.270678Z", "completed_at": "2025-07-18T13:57:10.281074Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.282052Z", "completed_at": "2025-07-18T13:57:10.282071Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021251201629638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.accepted_values_dim_customers_customer_value_tier__High_Value__Medium_Value__Low_Value__No_Value.6684d4fe26", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_value_tier as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_analytics\".\"main\".\"dim_customers\"\n    group by customer_value_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'High Value','Medium Value','Low Value','No Value'\n)\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"accepted_values_dim_customers_ef26879badf9745a7f6bba37fd1e92d2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.286175Z", "completed_at": "2025-07-18T13:57:10.297366Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.308212Z", "completed_at": "2025-07-18T13:57:10.308227Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029483318328857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_customers_email\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.291825Z", "completed_at": "2025-07-18T13:57:10.303608Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.310332Z", "completed_at": "2025-07-18T13:57:10.310345Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03228044509887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.299739Z", "completed_at": "2025-07-18T13:57:10.309235Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.312354Z", "completed_at": "2025-07-18T13:57:10.312367Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016026973724365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_total_orders.6e18bb41d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere total_orders is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_customers_total_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.304193Z", "completed_at": "2025-07-18T13:57:10.313459Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.316311Z", "completed_at": "2025-07-18T13:57:10.316323Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025565385818481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_full_name.101483d949", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere full_name is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_customers_full_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.320167Z", "completed_at": "2025-07-18T13:57:10.338087Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.340164Z", "completed_at": "2025-07-18T13:57:10.340182Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025437355041503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_total_revenue_dollars.b1ab3823ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere total_revenue_dollars is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"not_null_dim_customers_total_revenue_dollars\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.328110Z", "completed_at": "2025-07-18T13:57:10.339586Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.346377Z", "completed_at": "2025-07-18T13:57:10.346392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0293428897857666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"ecommerce_analytics\".\"main\".\"fct_orders\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"ecommerce_analytics\".\"main\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.333558Z", "completed_at": "2025-07-18T13:57:10.345487Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.347891Z", "completed_at": "2025-07-18T13:57:10.347905Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029742956161499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_dim_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-18T13:57:10.341376Z", "completed_at": "2025-07-18T13:57:10.347177Z"}, {"name": "execute", "started_at": "2025-07-18T13:57:10.349069Z", "completed_at": "2025-07-18T13:57:10.349078Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021744251251220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_dim_customers_email.0472f7c2e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_analytics\".\"main\".\"dim_customers\"\nwhere email is not null\ngroup by email\nhaving count(*) > 1\n\n\n", "relation_name": "\"ecommerce_analytics\".\"main_dbt_test__audit\".\"unique_dim_customers_email\"", "batch_results": null}], "elapsed_time": 1.1699261665344238, "args": {"macro_debugging": false, "exclude": [], "use_colors_file": true, "defer": false, "partial_parse_file_diff": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "empty_catalog": false, "log_path": "/home/runner/workspace/logs", "indirect_selection": "eager", "quiet": false, "state_modified_compare_vars": false, "static": false, "favor_state": false, "validate_macro_args": false, "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "log_level": "info", "introspect": true, "source_freshness_run_project_hooks": true, "printer_width": 80, "which": "generate", "project_dir": "/home/runner/workspace", "skip_nodes_if_on_run_start_fails": false, "show_all_deprecations": false, "log_level_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "use_fast_test_edges": false, "vars": {}, "show_resource_report": false, "profiles_dir": "/home/runner/workspace", "compile": true, "require_nested_cumulative_type_params": false, "select": [], "use_colors": true, "version_check": true, "write_json": true, "print": true, "static_parser": true, "log_format_file": "debug", "partial_parse": true, "require_all_warnings_handled_by_warn_error": false, "cache_selected_only": false, "log_format": "default", "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt docs generate", "send_anonymous_usage_stats": true, "upload_to_artifacts_ingest_api": false, "log_file_max_bytes": 10485760}}